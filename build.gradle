import com.jcabi.github.*

buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath "org.ajoberstar:gradle-git:1.3.0"
        classpath "com.jcabi:jcabi-github:0.23"
    }
}

apply plugin: 'org.ajoberstar.grgit'
apply plugin: 'org.ajoberstar.release-opinion'

tasks.release.doLast {
    def inferredVersion = version.inferredVersion
    if (inferredVersion.createTag) {
        def github = new RtGithub(ghToken)
        String tag = "v$inferredVersion.version"

        Repo repo = github.repos().get(new Coordinates.Simple('tschulte/github-releasetest'))

        Release release = repo.releases().create(tag)
        new Release.Smart(release).body("# Changelog of $inferredVersion.version")
    }
}
